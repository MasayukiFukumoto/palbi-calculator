<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="ja"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;PALBI Calculator Basic ver.2025.05&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Simple, mobile‑first CSS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>:root {</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,</p>
<p class="p1"><span class="Apple-converted-space">          </span>Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">        </span>line-height: 1.5;</p>
<p class="p1"><span class="Apple-converted-space">        </span>--primary: #0066cc;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>body {</p>
<p class="p1"><span class="Apple-converted-space">        </span>max-width: 720px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">        </span>padding: 2rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>h1 {</p>
<p class="p1"><span class="Apple-converted-space">        </span>color: var(--primary);</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-size: 1.6rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>label {</p>
<p class="p1"><span class="Apple-converted-space">        </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-weight: 600;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>input {</p>
<p class="p1"><span class="Apple-converted-space">        </span>width: 180px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>padding: 0.4rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>button {</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin-top: 1.2rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>padding: 0.6rem 1.2rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>background: var(--primary);</p>
<p class="p1"><span class="Apple-converted-space">        </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>border-radius: 4px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.grid {</p>
<p class="p1"><span class="Apple-converted-space">        </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">        </span>gap: 0.5rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.result {</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin-top: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>color: green;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.history {</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin-top: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>background: #f9f9f9;</p>
<p class="p1"><span class="Apple-converted-space">        </span>border: 1px solid #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.history h2 {</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin: 0 0 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.history ul {</p>
<p class="p1"><span class="Apple-converted-space">        </span>list-style: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>.history li + li {</p>
<p class="p1"><span class="Apple-converted-space">        </span>margin-top: 0.4rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h1&gt;PALBI Calculator&amp;nbsp;Basic ver.2025.05&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Age (years)&lt;input type="number" id="age" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;AST (U/L)&lt;input type="number" id="ast" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;ALT (U/L)&lt;input type="number" id="alt" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;PT‑INR&lt;input type="number" step="0.01" id="inr" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Bil (μmol/L)&lt;input type="number" id="bil" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Alb (g/L)&lt;input type="number" id="alb" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Platelets (10^9/L)&lt;input type="number" id="plt" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Ascites (1‑3)&lt;input type="number" id="asc" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;label&gt;Encephalopathy (1‑3)&lt;input type="number" id="enc" /&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button onclick="calc()"&gt;Calculate&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="result" id="out"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;section class="history" id="hist" hidden&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h2&gt;Recent (10)&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;ul id="histList"&gt;&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>function calc() {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Grab values</p>
<p class="p1"><span class="Apple-converted-space">        </span>const v = id =&gt; parseFloat(document.getElementById(id).value);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const age=v('age'), ast=v('ast'), alt=v('alt'), inr=v('inr'), bil=v('bil'), alb=v('alb'), plt=v('plt');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const asc=parseInt(document.getElementById('asc').value); const enc=parseInt(document.getElementById('enc').value);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if([age,ast,alt,inr,bil,alb,plt,asc,enc].some(x=&gt;isNaN(x))){</p>
<p class="p1"><span class="Apple-converted-space">          </span>out.innerHTML='&lt;span style="color:red"&gt;Please fill all fields.&lt;/span&gt;'; return;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>// PALBI</p>
<p class="p1"><span class="Apple-converted-space">        </span>const logB=Math.log10(bil), logP=Math.log10(plt);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const palbi=2.02*logB-0.37*logB**2-0.04*alb-3.48*logP+1.01*logP**2;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const palbiG=palbi&lt;=-2.53?'1':palbi&lt;=-2.09?'2':'3';</p>
<p class="p1"><span class="Apple-converted-space">        </span>// ALBI</p>
<p class="p1"><span class="Apple-converted-space">        </span>const albi=0.66*logB-0.0852*alb;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Fib‑4</p>
<p class="p1"><span class="Apple-converted-space">        </span>const fib4=(age*ast)/(plt*Math.sqrt(alt));</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Child‑Pugh</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bScore=bil&gt;51.3?3:bil&gt;34.2?2:1, aScore=alb&lt;28?3:alb&lt;35?2:1, iScore=inr&gt;1.7?3:inr&gt;1.5?2:1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const child=bScore+aScore+iScore+asc+enc; const cClass=child&lt;=6?'A':child&lt;=9?'B':'C';</p>
<p class="p1"><span class="Apple-converted-space">        </span>out.innerHTML=`PALBI &lt;b&gt;${palbi.toFixed(3)}&lt;/b&gt; (G${palbiG}) | ALBI &lt;b&gt;${albi.toFixed(3)}&lt;/b&gt; | Fib‑4 &lt;b&gt;${fib4.toFixed(2)}&lt;/b&gt; | C‑P &lt;b&gt;${child}&lt;/b&gt; (Class ${cClass})`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// History</p>
<p class="p1"><span class="Apple-converted-space">        </span>const key='liverToolHist';</p>
<p class="p1"><span class="Apple-converted-space">        </span>const h=JSON.parse(localStorage.getItem(key)||'[]');</p>
<p class="p1"><span class="Apple-converted-space">        </span>h.unshift({d:new Date().toLocaleString(), palbi:palbi.toFixed(2), albi:albi.toFixed(2), fib4:fib4.toFixed(1), cp:child});</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(h.length&gt;10)h.pop();</p>
<p class="p1"><span class="Apple-converted-space">        </span>localStorage.setItem(key,JSON.stringify(h));</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateHist();</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Simple usage counter</p>
<p class="p1"><span class="Apple-converted-space">        </span>localStorage.setItem('liverToolCount', (parseInt(localStorage.getItem('liverToolCount')||'0')+1));</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>function updateHist(){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const list=document.getElementById('histList');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const h=JSON.parse(localStorage.getItem('liverToolHist')||'[]');</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(!h.length){document.getElementById('hist').hidden=true;return;}</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('hist').hidden=false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>list.innerHTML=h.map(x=&gt;`&lt;li&gt;${x.d} – P:${x.palbi} A:${x.albi} F:${x.fib4} C‑P:${x.cp}&lt;/li&gt;`).join('');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Show run count in console for analytics demo</p>
<p class="p1"><span class="Apple-converted-space">      </span>console.info('Times used:', localStorage.getItem('liverToolCount')||0);</p>
<p class="p1"><span class="Apple-converted-space">      </span>updateHist();</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
